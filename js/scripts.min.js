function addKeyVal(n,t,i){for(var u=n,f=t.split("."),r=0;r<f.length-1;r++)typeof u[f[r]]=="undefined"&&(u[f[r]]={}),u=u[f[r]];typeof u[f[r]]=="object"&&typeof i=="object"?pushObj(u[f[r]],i):u[f[r]]=i}function pushObj(n,t){for(var i in t)typeof n[i]=="object"?pushObj(n[i],t[i]):n[i]=t[i]}function fetchObj(n,t){var i=n;return t.split(".").forEach(function(n){typeof i!="undefined"&&(i=i[n])}),i}function isDefined(n,t){return typeof t!="undefined"&&typeof n[t]!="undefined"}function onlyDefined(n,t){return typeof n=="undefined"?t:n}var app=angular.module("app",[]);app.directive("popupUrl",function(){return{scope:!0,restrict:"A",controller:function(n,t,i){i.bind("click",function(){console.log(t.popupUrl,"pop","width: "+t.popupWidth+", height: "+t.popupHeight);window.open(t.popupUrl,"pop","width="+t.popupWidth+", height="+t.popupHeight)})}}});app.directive("formSubmit",function(){return{scope:!0,restrict:"A",controller:function(n,t,i,r){n.errorsHandle={};typeof n.frm=="undefined"&&(n.frm={});r.bind("submit",function(){$.ajax({type:onlyDefined(i.formMethod,"POST"),url:i.formSubmit,data:n.frm,success:function(r,u,f){f.status===200&&(typeof i.formResult!="undefined"&&(n[i.formResult]=f.responseJSON),typeof i.formRootResult!="undefined"&&(t[i.formRootResult]=f.responseJSON),n.$apply(function(){n.errorsHandle={};typeof i.ngSuccess!="undefined"&&n.$eval(i.ngSuccess);typeof i.ngSuccessUrl!="undefined"&&(window.location=i.ngSuccessUrl)}))},error:function(t){t.status===400&&t.responseJSON.forEach(function(t){n.$apply(function(){n.errorsHandle[t.key]=t.errors})})}})})}}});app.directive("ngInputInfo",function(){return{restrict:"A",scope:!0,controller:function(n,t,i){n.$parent.$watch("errorsHandle."+t.ngInputInfo,function(t){typeof t=="undefined"&&(t=[]);n.errors=t;t.length===0?i.removeClass("has-error"):i.addClass("has-error")})}}});app.directive("selectUrl",function(){return{restrict:"A",scope:!0,controller:function(n,t,i){n.selected=0;n.display=i.selectText;n.UpdateSearch=function(){var t=typeof i.selectFilter=="undefined"?"filters."+i.selectModel:i.selectFilter,r=typeof t=="undefined"?n.filter:fetchObj(n.$parent,t);$.ajax({type:"GET",url:i.selectUrl,data:r,success:function(t,i,r){r.status===200&&n.$apply(function(){n.options=r.responseJSON})}})};n.$watch("filter",n.UpdateSearch,!0)}}});app.directive("selectModel",function(){return{restrict:"A",scope:!0,controller:function(n,t){var i=onlyDefined(t.selectFilter,"filters."+t.selectModel);n.$parent!==null&&(n.$parent.filters===null&&(n.$parent.filters={}),n.$watch("filter",function(){typeof n.filter!="undefined"&&addKeyVal(n.$parent,i,n.filter)},!0),n.$parent.$watch(i,n.UpdateSearch));n.setValue=function(i){typeof i=="undefined"&&(i={text:t.selectText});n.display=i.text;var u=t.selectModel,r=n.$parent;r===null&&(r=n);addKeyVal(r,"displays."+u,i.text);addKeyVal(r,u,i.value)}}}});app.directive("selectOption",function(){return{restrict:"A",scope:!0,controller:function(n,t){var i=n.$parent.option;t.bind("click",function(){n.$parent.$parent.$apply(function(n){var t=n.setValue;typeof t!="undefined"&&t(i)})});typeof i!="undefined"&&(n.display=i.text)}}});